CREATE VIEW v_total_spending_per_category AS 
SELECT c.category_name, SUM(e.amount) AS total_spent 
FROM categories c JOIN expenses e
ON c.category_id = e.category_id
GROUP BY c.category_name;

CREATE VIEW v_total_spending_per_payment_method AS 
SELECT p.method_name, SUM(e.amount) AS total_spent
FROM payment_methods p JOIN expenses e 
ON p.method_id = e.method_id 
GROUP BY p.method_name;

CREATE VIEW v_monthly_spending AS
SELECT DATE_FORMAT(expense_date,'%y-%m') AS month, 
       SUM(amount) AS total_spending_per_month 
FROM expenses 
GROUP BY month 
ORDER BY month;

CREATE VIEW v_daily_avg_spending AS
SELECT AVG(daily_total) FROM
(SELECT expense_date, SUM(amount) AS daily_total
 FROM expenses GROUP BY expense_date) AS per_day;
